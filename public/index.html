<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
  <title>S0LACE</title>

  <link rel="shortcut icon" href="favicon.ico" />
  <link rel="stylesheet" href="index.css" />

  <!-- Scramjet stack -->
  <script src="/scram/scramjet.all.js"></script>
  <script src="baremux/index.js" defer></script>
  <script src="epoxy/index.js" defer></script>
  <script src="register-sw.js" defer></script>
  <script src="search.js" defer></script>
  <script src="index.js" defer></script>

  <!-- global theme / settings -->
  <script src="global-hub.js" defer></script>

  <style>
    :root {
      --header-h: 64px;
    }

    /* ===== HEADER / PROXY FIX ===== */
    main { padding-top: var(--header-h); }

    body.sj-proxied main { padding-top: 0; }

    body.sj-proxied iframe,
    body.sj-proxied .scramjet-frame,
    body.sj-proxied .bare-frame {
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      border: none;
      z-index: 1;
    }

    body.sj-proxied .site-header {
      transform: translateY(-100%);
      transition: transform 0.25s ease;
    }

    .site-header {
      transition: transform 0.25s ease;
    }

    /* ===== BOTTOM ICONS ===== */
    #bottom-icons {
      position: fixed;
      bottom: 16px;
      left: 16px;
      display: flex;
      gap: 12px;
      z-index: 999;
    }
    #bottom-icons img {
      width: 28px;
      height: 28px;
      cursor: pointer;
      opacity: 0.75;
      transition: 0.2s;
    }
    #bottom-icons img:hover {
      opacity: 1;
      filter: drop-shadow(0 0 6px var(--accent));
    }

    /* ===== CENTER TEXT ===== */
    #motd {
      text-align: center;
      cursor: pointer;
    }

    .home-version {
      font-family: "Press Start 2P";
      font-size: 8px;
      color: var(--fg-dim);
      margin-top: 4px;
      text-align: center;
    }

    /* ===== POPULAR GAMES LOOP ===== */
    .popular-wrap {
      overflow: hidden;
      position: relative;
    }

    .popular-track {
      display: flex;
      width: max-content;
      animation: popular-scroll 40s linear infinite;
    }

    @keyframes popular-scroll {
      from { transform: translateX(0); }
      to { transform: translateX(-50%); }
    }

    /* ===== VISITOR PANEL ===== */
    .visitor-stats {
      display: flex;
      justify-content: space-around;
      padding: 8px 0;
    }
    .visitor-box {
      text-align: center;
      font-family: "Press Start 2P";
    }
    .visitor-label {
      font-size: 8px;
      color: var(--fg-dim);
    }
    .visitor-number {
      font-size: 14px;
      color: var(--accent);
      text-shadow: 0 0 6px var(--accent);
    }
  </style>
</head>

<body>

<!-- Bottom icons -->
<div id="bottom-icons">
  <img src="thumbs/trello.png" onclick="window.open('https://trello.com/b/GZg1EjXk/s0lace-tracking','_blank')" />
  <img src="thumbs/github.png" onclick="window.open('https://github.com/granthhss0/S0LACE','_blank')" />
</div>

<nav class="side-header">
  <a href="index.html" class="side-icon" data-icon="home" title="Home">
    <img />
  </a>
  <a href="games.html" class="side-icon" data-icon="games" title="Games">
    <img />
  </a>
  <a href="media.html" class="side-icon" data-icon="media" title="Media">
    <img />
  </a>
  <a href="settings.html" class="side-icon" data-icon="settings" title="Settings">
    <img />
  </a>
</nav>



<main class="home-main">

  <section class="home-center">
    <div class="home-logo-title">
      <div class="home-logo-mark">S0LACE</div>
      <div class="home-version">v1.0.5</div>
    </div>

    <section class="home-panel home-proxy-panel">
      <div id="motd">loading</div>

      <div style="margin-top:14px;">
        <div class="proxy-label">PR0XY &gt;</div>
        <form id="sj-form">
          <input id="sj-search-engine" value="https://www.google.com/search?q=%s" type="hidden" />
          <input id="sj-address" type="text" placeholder="type a url or search..." />
          <button class="proxy-btn" type="submit">GO</button>
        </form>
        <div id="sj-error"></div>
        <pre id="sj-error-code"></pre>
      </div>
    </section>
  </section>

  <!-- POPULAR GAMES -->
  <section class="home-panel home-popular-panel">
    <div class="motd-label">POPULAR GAMES</div>
    <div class="popular-wrap">
      <div class="popular-track">

      <a class="popular-pill" href="player.html?game=games/retrobowl/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/retrobowl.png')"></span>
        <span class="pill-name">Retro Bowl</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/balatro/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/balatro.jpeg')"></span>
        <span class="pill-name">Balatro</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/geometrydash/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/geometrydash.png')"></span>
        <span class="pill-name">Geometry Dash</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/monkey-mart/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/monkey-mart.jpeg')"></span>
        <span class="pill-name">Monkey Mart</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/level-devil/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/leveldevil.jpeg')"></span>
        <span class="pill-name">Level Devil</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/deadlydescent/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/deadlydescent.jpeg')"></span>
        <span class="pill-name">Deadly Descentspan>
      </a>

      <a class="popular-pill" href="player.html?game=games/gladdihoppers.html">
        <span class="pill-thumb" style="background-image:url('thumbs/gladdihoppers.png')"></span>
        <span class="pill-name">Gladihoppers</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/snow-rider/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/snow-rider.jpeg')"></span>
        <span class="pill-name">Snow Rider 3D</span>
      </a>


      <a class="popular-pill" href="player.html?game=games/drift-boss/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/drift-boss.jpeg')"></span>
        <span class="pill-name">Drift Boss</span>
      </a>

       <a class="popular-pill" href="player.html?game=games/retrobowl/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/retrobowl.png')"></span>
        <span class="pill-name">Retro Bowl</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/balatro/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/balatro.jpeg')"></span>
        <span class="pill-name">Balatro</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/geometrydash/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/geometrydash.png')"></span>
        <span class="pill-name">Geometry Dash</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/monkey-mart/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/monkey-mart.jpeg')"></span>
        <span class="pill-name">Monkey Mart</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/level-devil/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/leveldevil.jpeg')"></span>
        <span class="pill-name">Level Devil</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/deadlydescent/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/deadlydescent.jpeg')"></span>
        <span class="pill-name">Deadly Descentspan>
      </a>

      <a class="popular-pill" href="player.html?game=games/gladdihoppers.html">
        <span class="pill-thumb" style="background-image:url('thumbs/gladdihoppers.png')"></span>
        <span class="pill-name">Gladihoppers</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/snow-rider/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/snow-rider.jpeg')"></span>
        <span class="pill-name">Snow Rider 3D</span>
      </a>

      <!-- LOOP 2 -->
      <a class="popular-pill" href="player.html?game=games/retrobowl/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/retrobowl.png')"></span>
        <span class="pill-name">Retro Bowl</span>
      </a>

      <a class="popular-pill" href="player.html?game=games/drift-boss/index.html">
        <span class="pill-thumb" style="background-image:url('thumbs/drift-boss.jpeg')"></span>
        <span class="pill-name">Drift Boss</span>
      </a>

      </div>
    </div>
  </section>

  <!-- VISITORS -->
  <section class="home-panel">
    <div class="motd-label">VISITORS</div>
    <div class="visitor-stats">
      <div class="visitor-box">
        <div class="visitor-label">TODAY</div>
        <div id="vis-today" class="visitor-number">—</div>
      </div>
      <div class="visitor-box">
        <div class="visitor-label">THIS WEEK</div>
        <div id="vis-week" class="visitor-number">—</div>
      </div>
      <div class="visitor-box">
        <div class="visitor-label">ALL TIME</div>
        <div id="vis-all" class="visitor-number">—</div>
      </div>
    </div>
  </section>

</main>

<!-- MOTD -->
<script>
const motdEl = document.getElementById("motd");
const lines = [
  "any movie or show on media",
  "why are people actually using this site",
  "shout out to aurababy and 55gms",
  "if we average 2500 visitors per day im adding ads and selling out",
  "made during school",
  "stop giving me stupid suggestions",
  "why are people actually using this site",
  "as of 12/15 we are somehow averaging 500 viewer wth",
  "rip trinity",
  "what do yall know about moonlight",
  "need to finish adding custom domains",
  "s0lace discord???",
  "it welcome to derry finale was peak",
  "bro how are 500 people using this stupid site",
  "coding is confuzzling",
  "school admin im sowy for this site"
];
function setRandomMotd() {
  motdEl.textContent = lines[Math.floor(Math.random() * lines.length)];
}
motdEl.onclick = setRandomMotd;
setRandomMotd();
</script>

<script>
document.querySelectorAll(".side-icon").forEach(a => {
  if (a.href === location.href) a.classList.add("active");
});
</script>



<!-- Proxy detection -->
<script>
setInterval(() => {
  const proxied = document.querySelector("iframe,.scramjet-frame,.bare-frame");
  document.body.classList.toggle("sj-proxied", !!proxied);
}, 500);
</script>

<!-- FIREBASE VISITOR COUNTER (FIXED) -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const app = initializeApp({
  apiKey: "AIzaSyBbgy76ThxHaKlOhpiLQ6Nw4ekR1b9t3DA",
  authDomain: "s0lace-web.firebaseapp.com",
  databaseURL: "https://s0lace-web-default-rtdb.firebaseio.com",
  projectId: "s0lace-web"
});

const db = getDatabase(app);

function todayKey(){return new Date().toISOString().split("T")[0];}
function weekKey(){
  const d=new Date(),j=new Date(d.getFullYear(),0,1);
  return "week_"+Math.ceil((((d-j)/86400000)+j.getDay()+1)/7);
}

async function updateCounters(inc=false){
  const allRef=ref(db,"visitors/all");
  const todayRef=ref(db,"visitors/today/"+todayKey());
  const weekRef=ref(db,"visitors/week/"+weekKey());

  const all=(await get(allRef)).val()||0;
  const today=(await get(todayRef)).val()||0;
  const week=(await get(weekRef)).val()||0;

  if(inc){
    await set(allRef,all+1);
    await set(todayRef,today+1);
    await set(weekRef,week+1);
  }

  document.getElementById("vis-all").textContent = all + (inc?1:0);
  document.getElementById("vis-today").textContent = today + (inc?1:0);
  document.getElementById("vis-week").textContent = week + (inc?1:0);
}

if(!sessionStorage.getItem("s0lace-counted")){
  sessionStorage.setItem("s0lace-counted","1");
  updateCounters(true);
}else updateCounters(false);
</script>

<script>
const ICON_MAP = {
  green: "green",
  amber: "amber",
  violet: "purple",
  white: "white"
};

function updateSideIcons() {
  const accent = localStorage.getItem("s0laceAccent") || "gray";
  const color = ICON_MAP[accent] || "gray";

  document.querySelectorAll(".side-icon").forEach(a => {
    const name = a.dataset.icon;
    const img = a.querySelector("img");
    const isActive = a.href === location.href;

    img.src = `thumbs/${name} ${isActive ? color : "gray"}.png`;
  });
}

updateSideIcons();
window.addEventListener("storage", updateSideIcons);
</script>


</body>
</html>
